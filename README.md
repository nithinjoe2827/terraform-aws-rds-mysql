# terraform-aws-rds-mysql
[![tflint](https://github.com/rhythmictech/terraform-aws-rds-mysql/workflows/tflint/badge.svg?branch=master&event=push)](https://github.com/rhythmictech/terraform-aws-rds-mysql/actions?query=workflow%3Atflint+event%3Apush+branch%3Amaster)
[![tfsec](https://github.com/rhythmictech/terraform-aws-rds-mysql/workflows/tfsec/badge.svg?branch=master&event=push)](https://github.com/rhythmictech/terraform-aws-rds-mysql/actions?query=workflow%3Atfsec+event%3Apush+branch%3Amaster)
[![yamllint](https://github.com/rhythmictech/terraform-aws-rds-mysql/workflows/yamllint/badge.svg?branch=master&event=push)](https://github.com/rhythmictech/terraform-aws-rds-mysql/actions?query=workflow%3Ayamllint+event%3Apush+branch%3Amaster)
[![misspell](https://github.com/rhythmictech/terraform-aws-rds-mysql/workflows/misspell/badge.svg?branch=master&event=push)](https://github.com/rhythmictech/terraform-aws-rds-mysql/actions?query=workflow%3Amisspell+event%3Apush+branch%3Amaster)
[![pre-commit-check](https://github.com/rhythmictech/terraform-aws-rds-mysql/workflows/pre-commit-check/badge.svg?branch=master&event=push)](https://github.com/rhythmictech/terraform-aws-rds-mysql/actions?query=workflow%3Apre-commit-check+event%3Apush+branch%3Amaster)
<a href="https://twitter.com/intent/follow?screen_name=RhythmicTech"><img src="https://img.shields.io/twitter/follow/RhythmicTech?style=social&logo=twitter" alt="follow on Twitter"></a>

Create and manage an RDS MySQL instance. Includes the ability to manage the master password in Secrets Manager and manage the security group that controls RDS access.

## Usage
```
module "rds-mysql" {
  source = "rhythmictech/rds-mysql/aws"

  subnet_group_name = "db_subnet_group"
  vpc_id            = "vpc-1234567890"
}
```

<!-- BEGINNING OF PRE-COMMIT-TERRAFORM DOCS HOOK -->
## Requirements

| Name | Version |
|------|---------|
| terraform | >= 0.12.20 |

## Providers

| Name | Version |
|------|---------|
| aws | n/a |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| subnet\_group\_name | name of DB subnet group to place DB in | `string` | n/a | yes |
| vpc\_id | ID of VPC resources will be created in | `string` | n/a | yes |
| allowed\_cidr\_blocks | CIDR blocks allowed to reach the database | `list(string)` | `[]` | no |
| allowed\_ipv6\_cidr\_blocks | IPv6 CIDR blocks allowed to reach the database | `list(string)` | `[]` | no |
| allowed\_security\_groups | IDs of security groups allowed to reach the database (not Names) | `list(string)` | `[]` | no |
| backup\_retention\_period | How long to keep RDS backups (in days) | `number` | `5` | no |
| cloudwatch\_log\_exports | Log types to export to CloudWatch | `list(string)` | <pre>[<br>  "audit",<br>  "error",<br>  "general",<br>  "slowquery"<br>]</pre> | no |
| copy\_tags\_to\_snapshot | If `true`, RDS instance tags will be copied to snapshots | `bool` | `true` | no |
| enable\_deletion\_protection | If `true`, deletion protection will be turned on for the RDS instance(s) | `bool` | `true` | no |
| engine\_version | Version of database engine to use | `string` | `"5.7"` | no |
| final\_snapshot\_identifier | name of final snapshot (will be computed automatically if not specified) | `string` | `null` | no |
| iam\_database\_authentication\_enabled | Whether or not to enable IAM DB authentication | `bool` | `false` | no |
| identifier\_prefix | DB identifier prefix (will be generated by AWS automatically if not specified) | `string` | `null` | no |
| instance\_class | What instance type to use | `string` | `"db.t3.small"` | no |
| monitoring\_interval | Monitoring interval in seconds (`0` to disable enhanced monitoring) | `number` | `0` | no |
| monitoring\_role\_arn | Enhanced Monitoring ARN (blank to omit) | `string` | `null` | no |
| multi\_az | whether to make database multi-az | `bool` | `true` | no |
| name | common name for resources in this module | `string` | `"mysql-rds"` | no |
| parameters | Database parameters (will create parameter group if not null) | <pre>list(object({<br>    name  = string<br>    value = string<br>  }))</pre> | <pre>[<br>  {<br>    "name": "character_set_database",<br>    "value": "utf8"<br>  },<br>  {<br>    "name": "character_set_connection",<br>    "value": "utf8"<br>  },<br>  {<br>    "name": "character_set_filesystem",<br>    "value": "utf8"<br>  },<br>  {<br>    "name": "character_set_results",<br>    "value": "utf8"<br>  },<br>  {<br>    "name": "character_set_server",<br>    "value": "utf8"<br>  },<br>  {<br>    "name": "character_set_client",<br>    "value": "utf8"<br>  },<br>  {<br>    "name": "collation_connection",<br>    "value": "utf8_bin"<br>  },<br>  {<br>    "name": "collation_server",<br>    "value": "utf8_bin"<br>  },<br>  {<br>    "name": "max_allowed_packet",<br>    "value": "1073741824"<br>  }<br>]</pre> | no |
| pass\_version | Increment to force master user password change (not used if `password` is set) | `number` | `1` | no |
| password | Master password (if not set, one will be generated dynamically and exposed through a secret) | `string` | `null` | no |
| password\_length | Master password length (not used if `password` is set) | `number` | `30` | no |
| performance\_insights\_enabled | If true, performance insights will be enabled | `bool` | `false` | no |
| port | Port the database should listen on | `string` | `"3306"` | no |
| skip\_final\_snapshot | If `true` no final snapshot will be taken on termination | `bool` | `false` | no |
| storage | How much storage is available to the database | `string` | `20` | no |
| storage\_encrypted | Encrypt DB storage | `bool` | `true` | no |
| storage\_type | What storage backend to use (`gp2` or `standard`. io1 not supported) | `string` | `"gp2"` | no |
| tags | Tags to apply to supported resources | `map(string)` | `{}` | no |
| username | username of master user | `string` | `"mysql_user"` | no |

## Outputs

| Name | Description |
|------|-------------|
| address | RDS database address |
| instance\_connection\_info | Object containing connection info |
| instance\_id | Instance ID of RDS DB |
| password\_secret\_arn | Password secret ARN |
| password\_secret\_version\_id | Password secret version |
| username | Master username |

<!-- END OF PRE-COMMIT-TERRAFORM DOCS HOOK -->
